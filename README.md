# Shire Sample Sheet Data
***
## Introduction
This tool parses the output from the Query Shire Sample Sheet Data tool located at 
```
https://github.com/AWGL/query_shire
```

It contains functions that can be used to extract the data within Python for additional operations (e.g. generating sample sheets).

It is dependent on the jar file generated from the software at: ```https://github.com/AWGL/query_shire```

***
## Installation
This software uses Python 3.7.

It has dependencies which are recommended to be installed using a Conda environment. 
Install Conda:

```
https://docs.conda.io/projects/conda/en/latest/user-guide/install/download.html
```

Clone the repository:

```
git clone https://github.com/AWGL/sample_sheets
```

Create Conda environment:

```
conda env create -f shire.yml
```

Set up the config file to point to the correct locations on the local computer:


Edit ```config.py``` and save as ```config.py```


The code can then be run after the Conda environment is activated:

```
python sample_sheets.py
```
***
## Packaging for deployment
The software requires the jar file generated from the software at: ```https://github.com/AWGL/query_shire``` to be in the same directory as the sample_sheets.py script.

The software needs to be packaged to run on imaged PCs without Python installed. The package needs to be built on a Windows 7 PC with Python 3.7 installed.

Install pyinstaller if it is not already installed:

```
conda install pyinstaller
```

Package the software:

```
pyinstaller sample_sheets.py
```
***
## Deployment
Copy the dist directory generated by pyinstaller to the PC or shared drive from which the sofware is to be run. 

It may be useful to create a shortcut to the executable file ```sample_sheets.exe``` for the user.
***
## Instructions for usage
### Running the software
Double click on the ```sample_sheets.exe``` file.
### Using the software
The data extracted from Shire will be printed to the command prompt when the software is run. It is therefore recommended to launch the software from the Windows command prompt rather than by double-clicking on the .exe file:

```
python sample_sheets.py
```
	
***
## Testing
A test database (Testing.accdb) is provided. Tests can be run by launching the script ```test_sample_sheets.py```

***

## Troubleshooting


***
## Notes
### Current known issues
* None

### Dependency List
In case the Conda environment build fails.

* python 3.7
* pyinstaller
* The jar file generated from the software at: ```https://github.com/AWGL/query_shire```






